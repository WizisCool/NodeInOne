(function(){"use strict";var i={5776:function(i,e,t){var n=t(3751),o=t(641);const l={id:"app"};function a(i,e,t,n,a,s){const r=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.CE)("div",l,[(0,o.bF)(r)])}var s={name:"App"},r=t(6262);const u=(0,r.A)(s,[["render",a]]);var c=u,d=t(5220),b=t(33);const p={class:"subscription-container"},k={class:"header"},f={class:"header-buttons"},m=["onClick"],h=["title"];function g(i,e,t,n,l,a){const s=(0,o.g2)("SwitchButton"),r=(0,o.g2)("el-icon"),u=(0,o.g2)("el-button"),c=(0,o.g2)("Plus"),d=(0,o.g2)("el-table-column"),g=(0,o.g2)("Edit"),S=(0,o.g2)("DocumentCopy"),F=(0,o.g2)("Delete"),y=(0,o.g2)("el-popconfirm"),w=(0,o.g2)("el-space"),_=(0,o.g2)("el-table"),v=(0,o.g2)("el-card"),C=(0,o.g2)("el-input"),V=(0,o.g2)("el-form-item"),L=(0,o.g2)("el-form"),E=(0,o.g2)("el-dialog");return(0,o.uX)(),(0,o.CE)("div",p,[e[15]||(e[15]=(0,o.Lk)("h1",{class:"title"},"OneSub",-1)),(0,o.bF)(v,{class:"subscription-card"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",k,[e[8]||(e[8]=(0,o.Lk)("h2",null,"订阅列表",-1)),(0,o.Lk)("div",f,[(0,o.bF)(u,{type:"danger",plain:"",size:"medium",onClick:a.logout,class:"logout-btn"},{default:(0,o.k6)((()=>[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[(0,o.bF)(s)])),_:1}),e[6]||(e[6]=(0,o.eW)(" 登出 "))])),_:1},8,["onClick"]),(0,o.bF)(u,{type:"primary",plain:"",size:"medium",onClick:a.openAddSubscriptionModal},{default:(0,o.k6)((()=>[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[(0,o.bF)(c)])),_:1}),e[7]||(e[7]=(0,o.eW)(" 添加 "))])),_:1},8,["onClick"])])]),(0,o.bF)(_,{data:l.subscriptions,class:"subscription-table"},{default:(0,o.k6)((()=>[(0,o.bF)(d,{prop:"name",label:"名称",align:"center"}),(0,o.bF)(d,{label:"链接数量",align:"center",width:"120"},{default:(0,o.k6)((i=>[(0,o.eW)((0,b.v_)(i.row.links.length),1)])),_:1}),(0,o.bF)(d,{label:"订阅地址",align:"center",width:"300"},{default:(0,o.k6)((i=>[(0,o.Lk)("div",{class:"link-container",onClick:e=>a.copySubscriptionLink(i.row)},[(0,o.Lk)("span",{class:"link",title:a.getSubscriptionLink(i.row)},(0,b.v_)(a.getSubscriptionLink(i.row)),9,h)],8,m)])),_:1}),(0,o.bF)(d,{label:"操作",align:"center",width:"200"},{default:(0,o.k6)((i=>[(0,o.bF)(w,{size:"small"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{type:"primary",round:"",size:"small",onClick:e=>a.editSubscription(i.row)},{default:(0,o.k6)((()=>[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[(0,o.bF)(g)])),_:1})])),_:2},1032,["onClick"]),(0,o.bF)(u,{type:"primary",round:"",size:"small",onClick:e=>a.copySubscriptionLink(i.row)},{default:(0,o.k6)((()=>[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[(0,o.bF)(S)])),_:1})])),_:2},1032,["onClick"]),(0,o.bF)(y,{title:"确定要删除此订阅吗？","confirm-button-text":"确定","cancel-button-text":"取消",icon:"el-icon-warning",onConfirm:e=>a.deleteSubscription(i.row.id)},{reference:(0,o.k6)((()=>[(0,o.bF)(u,{type:"danger",round:"",size:"small"},{default:(0,o.k6)((()=>[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[(0,o.bF)(F)])),_:1})])),_:1})])),_:2},1032,["onConfirm"])])),_:2},1024)])),_:1})])),_:1},8,["data"])])),_:1}),(0,o.bF)(E,{title:"新建订阅",modelValue:l.addSubscriptionModalVisible,"onUpdate:modelValue":e[2]||(e[2]=i=>l.addSubscriptionModalVisible=i)},{footer:(0,o.k6)((()=>[(0,o.bF)(u,{plain:"",onClick:e[1]||(e[1]=i=>l.addSubscriptionModalVisible=!1)},{default:(0,o.k6)((()=>e[10]||(e[10]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(u,{type:"primary",plain:"",onClick:a.onAddSubscription},{default:(0,o.k6)((()=>e[11]||(e[11]=[(0,o.eW)("确认")]))),_:1},8,["onClick"])])),default:(0,o.k6)((()=>[(0,o.bF)(L,{model:l.newSubscription,"label-width":"100px"},{default:(0,o.k6)((()=>[(0,o.bF)(V,{label:"订阅名称"},{default:(0,o.k6)((()=>[(0,o.bF)(C,{modelValue:l.newSubscription.name,"onUpdate:modelValue":e[0]||(e[0]=i=>l.newSubscription.name=i)},null,8,["modelValue"])])),_:1}),(0,o.bF)(V,{label:"订阅链接"},{default:(0,o.k6)((()=>[(0,o.bF)(w,{direction:"vertical",size:"medium",fill:""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(l.newSubscription.links,((i,e)=>((0,o.uX)(),(0,o.CE)("div",{key:e,class:"link-input"},[(0,o.bF)(w,{size:"small",alignment:"center"},{default:(0,o.k6)((()=>[(0,o.bF)(C,{modelValue:l.newSubscription.links[e],"onUpdate:modelValue":i=>l.newSubscription.links[e]=i},null,8,["modelValue","onUpdate:modelValue"]),(0,o.bF)(u,{type:"danger",size:"small",onClick:i=>a.removeNewLink(e)},{default:(0,o.k6)((()=>[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[(0,o.bF)(F)])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])))),128)),(0,o.bF)(u,{type:"primary",plain:"",size:"small",onClick:a.addNewLink},{default:(0,o.k6)((()=>[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[(0,o.bF)(c)])),_:1}),e[9]||(e[9]=(0,o.eW)(" 添加链接 "))])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,o.bF)(E,{title:"编辑订阅",modelValue:l.editSubscriptionModalVisible,"onUpdate:modelValue":e[5]||(e[5]=i=>l.editSubscriptionModalVisible=i)},{footer:(0,o.k6)((()=>[(0,o.bF)(u,{plain:"",onClick:e[4]||(e[4]=i=>l.editSubscriptionModalVisible=!1)},{default:(0,o.k6)((()=>e[13]||(e[13]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(u,{type:"primary",plain:"",onClick:a.onEditSubscription},{default:(0,o.k6)((()=>e[14]||(e[14]=[(0,o.eW)("保存")]))),_:1},8,["onClick"])])),default:(0,o.k6)((()=>[(0,o.bF)(L,{model:l.editSubscriptionData,"label-width":"100px"},{default:(0,o.k6)((()=>[(0,o.bF)(V,{label:"订阅名称"},{default:(0,o.k6)((()=>[(0,o.bF)(C,{modelValue:l.editSubscriptionData.name,"onUpdate:modelValue":e[3]||(e[3]=i=>l.editSubscriptionData.name=i)},null,8,["modelValue"])])),_:1}),(0,o.bF)(V,{label:"订阅链接"},{default:(0,o.k6)((()=>[(0,o.bF)(w,{direction:"vertical",size:"medium",fill:""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(l.editSubscriptionData.links,((i,e)=>((0,o.uX)(),(0,o.CE)("div",{key:e,class:"link-input"},[(0,o.bF)(w,{size:"small",alignment:"center"},{default:(0,o.k6)((()=>[(0,o.bF)(C,{modelValue:l.editSubscriptionData.links[e],"onUpdate:modelValue":i=>l.editSubscriptionData.links[e]=i},null,8,["modelValue","onUpdate:modelValue"]),(0,o.bF)(u,{type:"danger",size:"small",onClick:i=>a.removeEditLink(e)},{default:(0,o.k6)((()=>[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[(0,o.bF)(F)])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])))),128)),(0,o.bF)(u,{plain:"",type:"primary",size:"small",onClick:a.addEditLink},{default:(0,o.k6)((()=>[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[(0,o.bF)(c)])),_:1}),e[12]||(e[12]=(0,o.eW)(" 添加链接 "))])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),e[16]||(e[16]=(0,o.Lk)("footer",{class:"footer"},[(0,o.Lk)("div",null,[(0,o.Lk)("a",{href:"https://github.com/WizisCool",target:"_blank",class:"footer-link"},"@WizisCool"),(0,o.Lk)("span",null," | "),(0,o.Lk)("a",{href:"https://github.com/WizisCool/OneSub",target:"_blank",class:"footer-link"},"项目仓库")]),(0,o.Lk)("div",null,"OneSub ©2025")],-1))])}t(4114),t(8992),t(4520);var S=t(4335),F=t(163),y={name:"UserDashboardView",data(){return{subscriptions:[],newSubscription:{name:"",links:[""]},addSubscriptionModalVisible:!1,editSubscriptionModalVisible:!1,editSubscriptionData:{id:null,name:"",links:[]}}},async created(){await this.fetchSubscriptions()},methods:{async fetchSubscriptions(){try{const i=await S.A.get("/api/subscriptions");this.subscriptions=i.data}catch(i){F.nk.error("加载订阅失败，请稍后重试"),console.error(i)}},async onAddSubscription(){try{const i=await S.A.post("/api/subscriptions",this.newSubscription);this.subscriptions.push(i.data),this.newSubscription={name:"",links:[""]},this.addSubscriptionModalVisible=!1,F.nk.success("订阅添加成功")}catch(i){F.nk.error("添加订阅失败，请稍后重试"),console.error(i)}},async deleteSubscription(i){try{await S.A.delete(`/api/subscriptions/${i}`),this.subscriptions=this.subscriptions.filter((e=>e.id!==i)),F.nk.success("订阅删除成功")}catch(e){F.nk.error("删除订阅失败，请稍后重试"),console.error(e)}},async toggleSubscriptionStatus(i){try{await S.A.put(`/api/subscriptions/${i.id}/status`,{enabled:i.enabled}),F.nk.success("订阅状态已更新")}catch(e){i.enabled=!i.enabled,F.nk.error("更新订阅状态失败，请稍后重试"),console.error(e)}},async editSubscription(i){this.editSubscriptionData={...i,links:[...i.links]},this.editSubscriptionModalVisible=!0},async onEditSubscription(){try{await S.A.put(`/api/subscriptions/${this.editSubscriptionData.id}`,this.editSubscriptionData);const i=this.subscriptions.findIndex((i=>i.id===this.editSubscriptionData.id));-1!==i&&(this.subscriptions[i]={...this.editSubscriptionData}),this.editSubscriptionModalVisible=!1,F.nk.success("订阅保存成功")}catch(i){F.nk.error("保存订阅失败，请稍后重试"),console.error(i)}},async logout(){try{await S.A.get("/logout"),window.location.href="/"}catch(i){F.nk.error("登出失败，请稍后重试"),console.error(i)}},getSubscriptionLink(i){return`${window.location.origin}/subscriptions/${i.id}`},copySubscriptionLink(i){navigator.clipboard.writeText(this.getSubscriptionLink(i)).then((()=>{F.nk.success("订阅链接已复制")})).catch((()=>{F.nk.error("复制订阅链接失败")}))},addNewLink(){this.newSubscription.links.push("")},removeNewLink(i){this.newSubscription.links.splice(i,1)},addEditLink(){this.editSubscriptionData.links.push("")},removeEditLink(i){this.editSubscriptionData.links.splice(i,1)},openAddSubscriptionModal(){this.addSubscriptionModalVisible=!0}}};const w=(0,r.A)(y,[["render",g],["__scopeId","data-v-7e79a06c"]]);var _=w;const v={class:"login-container"},C={class:"login-action"},V={href:"/auth/github"};function L(i,e,t,n,l,a){const s=(0,o.g2)("User"),r=(0,o.g2)("el-icon"),u=(0,o.g2)("el-button"),c=(0,o.g2)("el-card");return(0,o.uX)(),(0,o.CE)("div",v,[(0,o.bF)(c,{class:"login-card"},{default:(0,o.k6)((()=>[e[1]||(e[1]=(0,o.Lk)("div",{class:"login-header"},[(0,o.Lk)("h1",{class:"login-title"},"OneSub管理面板"),(0,o.Lk)("p",{class:"login-subtitle"},"Manage your nodes easily")],-1)),(0,o.Lk)("div",C,[(0,o.Lk)("a",V,[(0,o.bF)(u,{type:"primary",size:"large"},{default:(0,o.k6)((()=>[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[(0,o.bF)(s)])),_:1}),e[0]||(e[0]=(0,o.eW)(" 通过 GitHub 登录 "))])),_:1})])])])),_:1})])}var E={name:"UserLoginView"};const z=(0,r.A)(E,[["render",L],["__scopeId","data-v-4c8e03c9"]]);var D=z;async function O(){try{const i=await S.A.get("/api/auth/status");return i.data.authenticated}catch(i){return console.error("Error checking auth status:",i),!1}}const A=[{path:"/",name:"UserLoginView",component:D},{path:"/dashboard",name:"UserDashboardView",component:_,beforeEnter:async(i,e,t)=>{const n=await O();n?t():window.location.href="/auth/github"}}],M=(0,d.aE)({history:(0,d.LA)(),routes:A});var U=M,W=t(7146),x=(t(4188),t(8548));const j=(0,n.Ef)(c);for(const[X,I]of Object.entries(x))j.component(X,I);j.use(U),j.use(W.A),j.mount("#app")}},e={};function t(n){var o=e[n];if(void 0!==o)return o.exports;var l=e[n]={exports:{}};return i[n].call(l.exports,l,l.exports,t),l.exports}t.m=i,function(){var i=[];t.O=function(e,n,o,l){if(!n){var a=1/0;for(c=0;c<i.length;c++){n=i[c][0],o=i[c][1],l=i[c][2];for(var s=!0,r=0;r<n.length;r++)(!1&l||a>=l)&&Object.keys(t.O).every((function(i){return t.O[i](n[r])}))?n.splice(r--,1):(s=!1,l<a&&(a=l));if(s){i.splice(c--,1);var u=o();void 0!==u&&(e=u)}}return e}l=l||0;for(var c=i.length;c>0&&i[c-1][2]>l;c--)i[c]=i[c-1];i[c]=[n,o,l]}}(),function(){t.d=function(i,e){for(var n in e)t.o(e,n)&&!t.o(i,n)&&Object.defineProperty(i,n,{enumerable:!0,get:e[n]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(i){if("object"===typeof window)return window}}()}(),function(){t.o=function(i,e){return Object.prototype.hasOwnProperty.call(i,e)}}(),function(){t.r=function(i){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})}}(),function(){var i={524:0};t.O.j=function(e){return 0===i[e]};var e=function(e,n){var o,l,a=n[0],s=n[1],r=n[2],u=0;if(a.some((function(e){return 0!==i[e]}))){for(o in s)t.o(s,o)&&(t.m[o]=s[o]);if(r)var c=r(t)}for(e&&e(n);u<a.length;u++)l=a[u],t.o(i,l)&&i[l]&&i[l][0](),i[l]=0;return t.O(c)},n=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=t.O(void 0,[504],(function(){return t(5776)}));n=t.O(n)})();
//# sourceMappingURL=app.996b8901.js.map